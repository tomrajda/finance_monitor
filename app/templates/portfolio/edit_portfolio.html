{% extends "layout.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8 col-lg-7">
        <div class="card">
            <div class="card-header">
                <h3 class="mb-0">Edytuj: {{ portfolio.name }}</h3>
            </div>
            <div class="card-body">
                <form method="POST" action="{{ url_for('main.edit_portfolio', portfolio_id=portfolio.id) }}">
                    <div class="form-group">
                        <label for="name">Nazwa portfela</label>
                        <input type="text" class="form-control" id="name" name="name" value="{{ request.form.name or portfolio.name }}" required>
                    </div>
                    <div class="form-group">
                        <label for="description">Opis</label>
                        <textarea class="form-control" id="description" name="description" rows="3">{{ request.form.description or portfolio.description or '' }}</textarea>
                    </div>

                    <hr>
                    <h5>Docelowa alokacja</h5>
                    <p class="text-muted"><small>Wprowadź procentowy udział dla każdej kategorii aktywów. Suma powinna wynosić 100%. Pozostaw puste, jeśli kategoria nie wchodzi w skład modelowego portfela.</small></p>
                    
                    {% for category in asset_categories %}
                    <div class="form-group row">
                        <label for="alloc_{{ category.id }}" class="col-sm-4 col-form-label col-form-label-sm">{{ category.name }}</label>
                        <div class="col-sm-8">
                            <div class="input-group input-group-sm">
                                <!-- Użyj current_allocation[category.name] do wypełnienia wartości -->
                                <input type="number" step="0.01" min="0" max="100" class="form-control form-control-sm" 
                                       id="alloc_{{ category.id }}" name="alloc_{{ category.id }}" 
                                       value="{{ request.form['alloc_' ~ category.id] if request.form['alloc_' ~ category.id] is defined else (current_allocation.get(category.name) if current_allocation else '') }}"
                                       placeholder="np. 25">
                                <div class="input-group-append">
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                    
                    <button type="submit" class="btn btn-primary mt-3">Zapisz</button>
                    <a href="{{ url_for('main.portfolio_index', portfolio_id=portfolio.id) }}" class="btn btn-secondary mt-3 ml-2">Anuluj</a>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}